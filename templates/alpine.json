{
  "variables": {
    "source_image": "image-builder-fedora",
    "download_url": "http://dl-cdn.alpinelinux.org/alpine/latest-stable/releases/x86_64/alpine-minirootfs-3.9.0-x86_64.tar.gz",
    "download_path": "/home/guru/alpine-{{timestamp}}.tar.gz",
    "cloud_init_tmp_path": "/tmp/cloud_init.py",
    "img_fs": "ext4",
    "cloud_init_ds_dir": "/usr/lib/python3.6/site-packages/cloudinit/sources/",
    "cloud_init_ds_src": "./resources/cloud-init/ds_v2/DataSourceRbxCloud.py",
    "disk_size": "1",
    "image_name": "Alpine Linux (Mini)",
    "image_description": ""
  },
  "builders": [
    {
      "type": "hyperone",
      "vm_name": "packer-5c530ff0-bd94-1870-8fcb-d695f1fe66b7",
      "source_image": "{{user `source_image`}}",
      "vm_flavour": "a1.medium",
      "disk_size": 10,
      "ssh_keys": [
        "my-ssh"
      ],
      "chroot_disk": true,
      "chroot_command_wrapper": "sudo {{.Command}}",
      "chroot_disk_size": "{{user `disk_size`}}",
      "image_name": "{{user `image_name`}}",
      "image_description": "{{user `image_description`}}",
      "pre_mount_commands": [
        "sfdisk -uS --force \"{{.Device}}\" <<END\n2048,102400,ef\n104448,102400,b\n206848,,L,*\nEND",
        "partprobe",
        "sleep 1",
        "partprobe",
        "mkfs.fat {{.Device}}1",
        "mkfs.fat {{.Device}}2",
        "mkfs.{{user `img_fs`}} {{.Device}}3",
        "dosfslabel {{.Device}}1 EFI",
        "dosfslabel {{.Device}}2 CLOUDMD"
      ],
      "chroot_mount_path": "/tmp/mount",
      "mount_partition": 3,
      "post_mount_commands": [
        "mkdir -p {{.MountPath}}/boot/efi",
        "mount -t vfat {{.Device}}1 {{.MountPath}}/boot/efi",
        "wget {{user `download_url`}} -O {{user `download_path`}}",
        "tar xvzf {{user `download_path`}} -C {{.MountPath}}/"
      ]
    }
  ],
  "provisioners": [
  ]
}